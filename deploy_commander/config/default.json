{
	"roledefs":{
		"webserver": {
			"hosts": ["192.168.56.111"],
   			"config": {
				"192.168.56.111":{
					"ssh_password":"vagrant",
					"ssh_user":"vagrant"
				}
			}
		}
	},
	"environments":[
		"development",
		"production",
		"staging",
		"testing"
	],
	"params":{
		"domain":"demo.com",
		"user":"vagrant",
		"project_database_host":"localhost",
		"project_database_user":"root",
		"project_database_password":"root",
		"project_database_name":"example"
	},
	"post_params":{
		"base_path":"/home/%(user)s/%(environment)s/%(domain)s/deploy"
	},
	"actions":{
		"install-server":{
			"description":"Example setup development server",
			"commands":{
				"install-base":{
					"sequence":1,
					"command":"aptget.install",
					"params":{
						"package":"git"
					}
				},
				"install-mysql":{
					"sequence":2,
					"command":"mysql.install_server"
				}
			}
		},
		"install-app":{
			"description":"Install application on server",
			"commands":{
				"git-clone":{
					"sequence":1,
					"command":"git.clone",
					"description":"First repo cloning...",
					"params":{
						"repo_path":"%(base_path)s/repo",
						"repo_url":"will-be-overwritten-by-project"
					}
				},
				"create-mysql-db":{
					"sequence":2,
					"command":"mysql.query",
					"params":{
						"host":"%(project_database_host)s",
						"user":"%(project_database_user)s",
						"password":"%(project_database_password)s",
						"query":"CREATE DATABASE IF NOT EXISTS %(project_database_name)s"
					}
				},
				"import-project-db":{
					"sequence":3,
					"command":"mysql.import_file",
					"params":{
						"host":"%(project_database_host)s",
						"user":"%(project_database_user)s",
						"password":"%(project_database_password)s",
						"database":"%(project_database_name)s",
						"import_file":"%(base_path)s/repo/.data/install.sql"
					}
				}
			}
		},
		"deploy-app":{
			"description":"Deploy project",
			"commands":{
				"git-deploy-tag":{
					"sequence":1,
					"command":"git.deploy_tag",
					"params":{
						"repo_path":"%(base_path)s/repo",
						"tag_path":"%(base_path)s/source/%(tag)s"
					}
				},
				"upload-environment-config":{
					"sequence":2,
					"command":"system.upload_template",
					"params":{
						"source":"demo/config.php",
						"target":"%(base_path)s/source/%(tag)s/config.php",
						"dbname":"%(project_database_name)s",
						"dbpassword":"%(project_database_password)s",
						"dbuser":"%(project_database_user)s"
					}
				},
				"mysql-backup":{
					"sequence":3,
					"command":"mysql.backup_db",
					"params":{
						"host":"%(project_database_host)s",
						"user":"%(project_database_user)s",
						"password":"%(project_database_password)s",
						"database":"%(project_database_name)s",
						"backup_path":"%(base_path)s/db_backup"
					}
				},
				"list-source":{
					"sequence":4,
					"command":"system.command",
					"params":{
						"command":"ls -las %(base_path)s/source/%(tag)s"
					}
				},
				"symlink-current-folder":{
					"sequence":5,
					"command":"system.symlink",
					"params":{
						"source":"%(base_path)s/current",
						"target":"%(base_path)s/source/%(tag)s"
					}
				}
			}
		},
		"rollback-app":{
			"description":"Rollback application",
			"input_params":{
				"tag":{
					"param":"tag",
					"prompt":"Rollback to which tag?"
				}
			},
			"commands":{
				"symlink-current-folder":{
					"sequence":1,
					"command":"system.symlink",
					"params":{
						"source":"%(base_path)s/current",
						"target":"%(base_path)s/source/%(tag)s"
					}
				},
				"mysql-import":{
					"sequence":2,
					"command":"mysql.restore_db",
					"confirm":"Restore a database backup?",
					"params":{
						"host":"%(project_database_host)s",
						"user":"%(project_database_user)s",
						"password":"%(project_database_password)s",
						"database":"%(project_database_name)s",
						"backup_path":"%(base_path)s/db_backup"
					}
				}
			}
		}
	}
}